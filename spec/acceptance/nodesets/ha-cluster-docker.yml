---
# Two-node HA cluster nodeset for testing high-availability features
# Primary node (Debian 12) + Replica node (Debian 12) for consistent testing

HOSTS:
  primary:
    platform: debian-12-arm64
    hypervisor: docker
    image: debian:12
    docker_preserve_image: true
    docker_cmd: '["/sbin/init"]'
    docker_image_commands:
      - 'apt-get update && apt-get install -y systemd systemd-sysv wget gnupg lsb-release ca-certificates iproute2 procps dnsutils iputils-ping curl net-tools'
      - 'wget https://apt.voxpupuli.org/openvox8-release-debian12.deb'
      - 'dpkg -i openvox8-release-debian12.deb'
      - 'apt-get update && apt-get install -y openvox-agent'
      - 'ln -sf /opt/puppetlabs/bin/puppet /usr/bin/puppet'
    roles:
      - agent
      - primary

  replica:
    platform: debian-12-arm64
    hypervisor: docker
    image: debian:12
    docker_preserve_image: true
    docker_cmd: '["/sbin/init"]'
    docker_image_commands:
      - 'apt-get update && apt-get install -y systemd systemd-sysv wget gnupg lsb-release ca-certificates iproute2 procps dnsutils iputils-ping curl net-tools'
      - 'wget https://apt.voxpupuli.org/openvox8-release-debian12.deb'
      - 'dpkg -i openvox8-release-debian12.deb'
      - 'apt-get update && apt-get install -y openvox-agent'
      - 'ln -sf /opt/puppetlabs/bin/puppet /usr/bin/puppet'
    roles:
      - agent
      - replica

CONFIG:
  log_level: verbose
  type: aio
